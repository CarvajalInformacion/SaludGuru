@model MarketPlace.Models.Profile.ProfileViewModel

@if (!Model.RenderScripts)
{
    <div>
        <div id="divOfficeMap" style="width:800px;height:800px;">
        </div>
    </div>

    <!--templates-->
    <div style="display:none;">
    </div>
}
else
{
    //create office calendar object
    var oBaseController = ViewContext.Controller as MarketPlace.Web.Controllers.BaseController;

    string oOfficeInfo = (new System.Web.Script.Serialization.JavaScriptSerializer()).
        Serialize(Model.CurrentProfile.RelatedOffice.
            Where(of => of.City.CityId == oBaseController.CurrentCookie.CurrentCity).
            Select(of =>
                new
                {
                    ProfilePublicId = Model.CurrentProfile.ProfilePublicId,
                    ProfileImage = Model.CurrentProfile.ProfileInfo.
                        Where(x => x.ProfileInfoType == SaludGuruProfile.Manager.Models.enumProfileInfoType.ImageProfileSmall).
                        Select(x => x.Value).
                        DefaultIfEmpty(string.Empty).
                        FirstOrDefault(),
                    OfficePublicId = of.OfficePublicId,
                    OfficeName = of.Name,
                    OfficeDescription = of.OfficeInfo,
                    IsDefault = of.IsDefault,
                    City = of.City,
                }).OrderBy(x => x.IsDefault).
                OrderBy(x => x.OfficeName).ToList());

    <script type="text/javascript">
        $(document).ready(function () {
            ProfileMapObject.Init({
                DivId: 'divOfficeMap',
                OfficeInfo : @Html.Raw(oOfficeInfo),
            });
            ProfileMapObject.RenderAsync();
        });
    </script>
}